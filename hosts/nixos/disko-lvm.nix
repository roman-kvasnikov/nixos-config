{
  # Основной блок конфигурации disko
  disko.devices = {
    # Секция для физических дисков
    disk = {
      # Имя диска в конфигурации (можно назвать как угодно)
      main = {
        # Указываем, что это физический диск
        type = "disk";

        # Путь к устройству в системе
        # /dev/vdb - виртуальный диск (для VM)
        # /dev/sda - первый SATA диск
        # /dev/nvme0n1 - первый NVMe SSD
        device = "/dev/sda";

        # Содержимое диска - схема разметки
        content = {
          # Тип таблицы разделов - GPT (современный стандарт для UEFI)
          # GPT лучше MBR: поддерживает диски >2TB и больше разделов
          type = "gpt";

          # Список разделов на диске
          partitions = {
            # EFI System Partition - загрузочный раздел для UEFI
            ESP = {
              # Размер раздела - 500 мегабайт
              size = "500M";

              # Тип раздела EF00 - стандартный код для EFI раздела
              type = "EF00";

              # Что делать с этим разделом
              content = {
                # Создать файловую систему
                type = "filesystem";

                # FAT32 - обязательный формат для UEFI boot
                format = "vfat";

                # Куда монтировать в системе
                mountpoint = "/boot";

                # Опции монтирования
                # umask=0077 - права доступа (только root может читать/писать)
                mountOptions = ["umask=0077"];
              };
            };

            # Зашифрованный раздел
            luks = {
              # Занимает всё оставшееся место на диске
              size = "100%";

              # Содержимое - LUKS шифрование
              content = {
                # Тип - LUKS (Linux Unified Key Setup) для шифрования
                type = "luks";

                # Имя расшифрованного устройства в /dev/mapper/crypted
                name = "crypted";

                # Дополнительные аргументы для cryptsetup open (пусто)
                extraOpenArgs = [];

                # Настройки LUKS
                settings = {
                  # Файл с паролем для автоматической расшифровки
                  # Закомментируйте для интерактивного ввода пароля
                  # keyFile = "/tmp/secret.key";

                  # Разрешает TRIM команды для SSD (может быть менее безопасно,
                  # но улучшает производительность и срок службы SSD)
                  allowDiscards = true;
                };

                # Что находится внутри зашифрованного контейнера
                content = {
                  # LVM Physical Volume - физический том для LVM
                  type = "lvm_pv";

                  # Имя группы томов (Volume Group)
                  vg = "nixos-vg";
                };
              };
            };
          };
        };
      };
    };

    # Секция для LVM Volume Groups
    lvm_vg = {
      # Имя группы томов (должно совпадать с vg выше)
      nixos-vg = {
        # Указываем, что это LVM Volume Group
        type = "lvm_vg";

        # Логические тома (Logical Volumes) внутри группы
        lvs = {
          # Раздел подкачки (swap)
          swap = {
            # Фиксированный размер 8 гигабайт
            size = "8G";

            content = {
              # Тип - раздел подкачки
              type = "swap";

              # Включить случайное шифрование swap при каждой загрузке
              # (ключ генерируется случайно, данные теряются при перезагрузке)
              randomEncryption = true;
            };
          };

          # Корневой раздел
          root = {
            # Фиксированный размер 30 гигабайт
            # Можно указать: "50G", "100%", "50%VG"
            size = "60G";

            # Содержимое логического тома
            content = {
              # Создать файловую систему
              type = "filesystem";

              # ext4 - стандартная ФС для Linux
              format = "ext4";

              # Точка монтирования - корень системы
              mountpoint = "/";

              # Опции монтирования
              mountOptions = [
                # Стандартные опции (rw, suid, dev, exec, auto, nouser, async)
                "defaults"

                # Не обновлять время доступа к файлам (экономит ресурс SSD)
                "noatime"
              ];
            };
          };

          # Домашний раздел
          home = {
            # Использовать всё свободное место в группе томов
            size = "100%FREE";

            content = {
              type = "filesystem";
              format = "ext4";

              # Монтируется в /home
              mountpoint = "/home";

              mountOptions = [
                "defaults"
                "noatime"
              ];
            };
          };
        };
      };
    };
  };
}
